import{r as e,j as a,a as t,R as i,L as s}from"./index-dWbV2YWN.js";import{j as n,T as r,l,L as d,v as o,w as c,x as m}from"./endpoints-C8SDwtyd.js";import{B as u}from"./button-BYsJFizr.js";import{C as p,n as g}from"./table_util-DcgUt5Gf.js";import{T as x}from"./timestamp-ykkkBbSZ.js";import{StaticViewGraph as h}from"./view_graph-lHRhEpe-.js";import{ViewCommand as v}from"./view_command-BTpK9OuZ.js";import{e as j}from"./copytoclipboard-Cy7DO2po.js";import{E as b}from"./bulkwrapper-lVatfgrI.js";import f from"./chevron-up-B4YDzb8G.js";import k from"./chevron-down-BDk-k6Dz.js";import"./SimpleChart-CDY-4U1s.js";import"./theme-provider-UldqYbSh.js";import"./edit_graph-0sow33za.js";import"./apiform-Cee87rao.js";import"./StateUtil-moXfkR8g.js";import"./MarkupRenderer-CugZClZz.js";import"./loading-DZKuFaBE.js";import"./input-hcSfkvL2.js";import"./useQuery-DQU7waJ6.js";import"./index-C43Ddswy.js";import"./CmdList-BdDeEO7B.js";import"./useSuspenseQuery-C4hISphF.js";import"./createLucideIcon-BbV9mzym.js";const C=({id:t,label:i,value:s,expandedContent:n,buttons:r,className:l="",isEven:d=!1})=>{const[o,c]=e.useState(!1),[m,p]=e.useState(!1),g=e.useCallback((()=>{o||m||p(!0),c(!o)}),[o,m]),x=e.useMemo((()=>`divide-x divide-primary/5 ${d?"bg-primary/5":""} ${l}`),[d,l]),h=!!n,v=e.useMemo((()=>h?a.jsxs(u,{variant:"outline",size:"sm",className:"flex items-center gap-2 p-2",onClick:g,children:[a.jsx("span",{children:s}),o?a.jsx(f,{size:16}):a.jsx(k,{size:16})]}):null),[h,s,o,g]),j=e.useMemo((()=>o?a.jsx("tr",{className:d?"bg-primary/5":"",children:a.jsx("td",{colSpan:2,className:"p-0",children:a.jsx("div",{className:"p-3 border-t border-primary/10 animate-in fade-in duration-200",children:m&&n})})},`expanded-${t}`):null),[o,m,n,t,d]);return a.jsxs(a.Fragment,{children:[a.jsxs("tr",{className:x,children:[i&&a.jsx("td",{className:"p-1 min-w-fit whitespace-nowrap font-medium text-right pr-3",children:i}),a.jsx("td",{className:"p-1 w-full",colSpan:i?1:2,children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{children:h?v:s}),r&&a.jsx("div",{className:"",children:r})]})})]},`row-${t}`),j]})},O=n.placeholders("DBAlliance").aliased().add({cmd:"getname",alias:"name"}).add({cmd:"getid",alias:"id"}).add({cmd:"getrank",alias:"rank"}).add({cmd:"getacronym",alias:"acronym"}).add({cmd:"getflag",alias:"flag"}).add({cmd:"getforum_link",alias:"forumLink"}).add({cmd:"getdiscord_link",alias:"discordLink"}).add({cmd:"getwiki_link",alias:"wikiLink"}).add({cmd:"getdatecreated",alias:"dateCreated"}).add({cmd:"getcolor",alias:"color"}).add({cmd:"getscore",alias:"score"}).add({cmd:"getestimatedstockpilevalue",alias:"stockpileValue"}).add({cmd:"getestimatedstockpile",alias:"stockpile"}).add({cmd:"getlootvalue",args:{score:"1"},alias:"lootValue"}).add({cmd:"getrevenueconverted",alias:"revenue"}).add({cmd:"getcostconverted",alias:"cost"}).add({cmd:"countmembers",alias:"memberCount"}).add({cmd:"countnations",args:{filter:"#position=1"},alias:"applicantCount"}).add({cmd:"countnations",args:{filter:"#isTaxable"},alias:"taxableCount"}).add({cmd:"getnumtreasures",alias:"treasures"}).add({cmd:"countnations",args:{filter:"#color=gray,#vm_turns=0"},alias:"grayCount"}).add({cmd:"countnations",args:{filter:"#color=gray,#vm_turns=0,#active_m<7200"},alias:"activeGrayCount"}).add({cmd:"countnations",args:{filter:"#cities<10,#FreeOffensiveSlots>0,(#color!=beige|#isblockaded=0)"},alias:"c10WithoutRaids"}).add({cmd:"getcities",alias:"cities"}).add({cmd:"getaverage",args:{attribute:"avgland",filter:"#position>1,#vm_turns=0"},alias:"land_avg"}).add({cmd:"getaverage",args:{attribute:"avg_infra",filter:"#position>1,#vm_turns=0"},alias:"infra_avg"}).add({cmd:"gettotal",args:{attribute:"cityvalue",filter:"#position>1,#vm_turns=0"},alias:"cityValue"}),A=[{label:null,value:e=>{return a.jsxs("div",{className:"flex items-center space-x-2",children:[e.flag&&a.jsx("img",{src:e.flag,alt:"Alliance flag",className:"w-16 h-10"}),a.jsxs(s,{className:"text-2xl font-bolt flex items-center",to:(t=`alliance/id=${e.id}`,`https://politicsandwar.com/${t}`),children:[e.name," ",a.jsx(d,{name:"ExternalLink"})]}),e.acronym&&a.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.acronym,")"]})]});var t}},{label:null,buttons:[{text:()=>"Forum",path:e=>e.forumLink,condition:e=>!!e.forumLink},{text:()=>"Discord",path:e=>e.discordLink,condition:e=>!!e.discordLink},{text:()=>"Wiki",path:e=>e.wikiLink,condition:e=>!!e.wikiLink},{text:e=>`${e.memberCount} Members`,path:e=>`/nations/AA:${e.id},#position>1`,condition:e=>e.memberCount>0},{text:e=>`${e.taxableCount} Taxable`,path:e=>`/nations/AA:${e.id},#isTaxable`,condition:e=>e.taxableCount>0},{text:e=>`${e.applicantCount} Applicants`,path:e=>`/nations/AA:${e.id},#position=1`,condition:e=>e.applicantCount>0}]},{label:"Created",value:e=>a.jsx(x,{millis:e.dateCreated})},{label:"Color",value:e=>a.jsxs("div",{className:"flex items-center",children:[a.jsx(p,{colorId:e.color}),a.jsx("span",{children:e.color})]})},{label:"Rank",value:e=>a.jsxs(a.Fragment,{children:["#",l(e.rank)]})},{label:"Score",value:e=>a.jsxs(a.Fragment,{children:[l(e.score),"ns"]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(v,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{score}",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:o,args:{metric:"score",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]})},{label:"Stockpile Value (Est.)",value:e=>a.jsxs(a.Fragment,{children:["$",l(e.stockpileValue)]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(v,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{getestimatedstockpilevalue}",num_results:"5",highlight:e.id+""}}),a.jsx(j,{text:g(e.stockpileValue)})]})},{label:"Loot Per Score",value:e=>a.jsxs(a.Fragment,{children:["$",l(e.lootValue)]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(v,{command:["alliance","stats","loot_ranking"],args:{time:"30d",num_results:"5",highlight:"AA:"+e.id}}),a.jsx("hr",{}),"Alliance Loot Losses:",a.jsx(v,{command:["stats_war","warcostranking"],args:{timeStart:"30d",type:"ATTACKER_LOSSES",allowedAttacks:"A_LOOT",groupByAlliance:"true",num_results:"5",highlight:"AA:"+e.id}})]})},{label:"Revenue Converted",value:e=>a.jsxs(a.Fragment,{children:["$",l(e.revenue)]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(v,{command:["trade","findproducer"],args:{resources:"*",includeNegative:"true",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:c,args:{metrics:"revenue",coalition:"aa:"+e.id,start:"timestamp:"+e.dateCreated,end:"0"}}),a.jsx(v,{command:["alliance","revenue"],args:{nations:"AA:"+e.id}})]})},{label:"Alliance Value",value:e=>a.jsxs(a.Fragment,{children:["$",l(e.cost)]}),expandable:!0,expandedContent:e=>a.jsx(a.Fragment,{children:a.jsx(v,{command:["alliance","cost"],args:{nations:"AA:"+e.id}})})},{label:"Gray (non VM)",buttons:[{text:e=>`${e.grayCount} All`,path:e=>`/nations/AA:${e.id},#color=gray,#vm_turns=0`},{text:e=>`${e.activeGrayCount} Active (5d)`,path:e=>`/nations/AA:${e.id},#color=gray,#vm_turns=0,#active_m<7200`}]},{label:"&#91;C10 without raids",buttons:[{text:e=>`${e.c10WithoutRaids} Nations`,path:e=>`/nations/AA:${e.id},#cities<10,#FreeOffensiveSlots>0,(#color!=beige|#isblockaded=0)`}]},{label:"Treasures",value:e=>a.jsxs(a.Fragment,{children:[l(e.treasures)," (",Math.sqrt(4*e.treasures).toFixed(2),"%)"]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(v,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{numtreasures}",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:o,args:{metric:"treasure",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]}),buttons:[{text:()=>"View",path:e=>`/treasures/AA:${e.id},#treasure`,condition:e=>e.treasures>=0}]},{label:"Cities",value:e=>a.jsxs(a.Fragment,{children:[l(e.cities)," ($",l(4*e.cities),")"]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(v,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{getcities}",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:o,args:{metric:"city",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]}),buttons:[{text:()=>"View",path:e=>`/cities/AA:${e.id},#cities`,condition:e=>e.cities>=0}]},{label:"Infra Avg.",value:e=>l(e.infra_avg),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(h,{endpoint:m,args:{metric:"avg_infra",groupBy:"cities",coalition1:"aa:"+e.id}}),a.jsx(h,{endpoint:o,args:{metric:"infra_avg",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]})},{label:"Land Avg.",value:e=>l(e.land_avg),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(h,{endpoint:m,args:{metric:"avg_land",groupBy:"cities",coalition1:"aa:"+e.id}}),a.jsx(h,{endpoint:o,args:{metric:"avg_land",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]})},{label:"MMR",value:()=>"TODO (non tooltip) unit= | build=\nTODO MMR over time + MMR tier graph"},{label:"Soldier %",value:()=>"TODO unit tier graph, unit over time"},{label:"Tank %",value:()=>"TODO unit tier graph, unit over time"},{label:"Aircraft %",value:()=>"TODO unit tier graph, unit over time"},{label:"Ships %",value:()=>"TODO unit tier graph, unit over time"},{label:"Missiles",value:()=>"TODO num missiles (... avg)\nTODO MLP tier graph\nTODO missiles over time\nTODO ranking"},{label:"Nukes",value:()=>"TODO num nukes (... avg)\nTODO nuke tier graph\nTODO NRF tier graph\nTODO nuke over time\nTODO ranking"},{label:"Spies",value:()=>"TODO Spy tier graph\nTODO avg spies over time"},{label:"Active Wars",value:()=>"TODO Off: 5, Def: 5 (10 Total)\nTODO Wars by tier\nTODO strength tier graph"}],_=i.memo((({data:e})=>{if(2!=e.cells.length)return a.jsx(a.Fragment,{children:JSON.stringify(e)});const t=O.createRowAdapter(e.cells[1]),i=A.map(((e,i)=>{if(e.condition&&!e.condition(t))return null;const n=e.buttons?a.jsx(a.Fragment,{children:e.buttons.map(((e,i)=>{if(e.condition&&!e.condition(t))return null;const n="function"==typeof e.text?e.text(t):e.text;return a.jsx(u,{className:i>0?"ms-1":"",variant:"outline",size:"sm",asChild:!0,children:a.jsx(s,{to:e.path(t),children:n})},i)}))}):null;return a.jsx(C,{id:i,label:e.label,value:e.value?e.value(t):null,expandedContent:e.expandable&&e.expandedContent?e.expandedContent(t):void 0,buttons:n,isEven:i%2==0},"row-"+i)}));return a.jsx("div",{className:"rounded-lg border border-primary/20 shadow-sm",children:a.jsxs("table",{className:"display text-xs compact font-mono w-full bg-accent",children:[a.jsxs("colgroup",{children:[a.jsx("col",{className:"w-auto"})," ",a.jsx("col",{className:"w-full"})," "]}),a.jsx("tbody",{className:"divide-y divide-primary/5",children:i})]})})}));function y(){const{alliance:e}=t();return a.jsx(b,{endpoint:r,args:{type:"Alliance",selection_str:e,columns:O.array()},children:({data:e})=>a.jsx(_,{data:e})})}export{y as default};
